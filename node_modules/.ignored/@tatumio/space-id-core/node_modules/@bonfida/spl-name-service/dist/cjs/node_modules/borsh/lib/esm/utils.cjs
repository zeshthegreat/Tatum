"use strict";var t,e=require("./types.cjs"),n=(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});var r=e.integers.concat(["bool","string"]),o=["option","enum","array","set","map","struct"],c=function(t){function e(e,n){var r="Invalid schema: ".concat(JSON.stringify(e)," expected ").concat(n);return t.call(this,r)||this}return n(e,t),e}(Error);function i(t){if("string"!=typeof t||!r.includes(t)){if(t&&"object"==typeof t){var e=Object.keys(t);if(1===e.length&&o.includes(e[0])){var n=e[0];if("option"===n)return i(t[n]);if("enum"===n)return function(t){if(!Array.isArray(t))throw new c(t,"Array");for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"!=typeof r||!("struct"in r))throw new Error('Missing "struct" key in enum schema');if("object"!=typeof r.struct||1!==Object.keys(r.struct).length)throw new Error('The "struct" in each enum must have a single key');i({struct:r.struct})}}(t[n]);if("array"===n)return function(t){if("object"!=typeof t)throw new c(t,"{ type, len? }");if(t.len&&"number"!=typeof t.len)throw new Error("Invalid schema: ".concat(t));if("type"in t)return i(t.type);throw new c(t,"{ type, len? }")}(t[n]);if("set"===n)return i(t[n]);if("map"===n)return function(t){if("object"!=typeof t||!("key"in t)||!("value"in t))throw new c(t,"{ key, value }");i(t.key),i(t.value)}(t[n]);if("struct"===n)return function(t){if("object"!=typeof t)throw new c(t,"object");for(var e in t)i(t[e])}(t[n])}}throw new c(t,o.join(", ")+" or "+r.join(", "))}}exports.ErrorSchema=c,exports.expect_bigint=function(t,e){if(!["number","string","bigint","boolean"].includes(typeof t)&&!("object"==typeof t&&null!==t&&"toString"in t))throw new Error("Expected bigint, number, boolean or string not ".concat(typeof t,"(").concat(t,") at ").concat(e.join(".")))},exports.expect_enum=function(t,e){if("object"!=typeof t||null===t)throw new Error("Expected object not ".concat(typeof t,"(").concat(t,") at ").concat(e.join(".")))},exports.expect_same_size=function(t,e,n){if(t!==e)throw new Error("Array length ".concat(t," does not match schema length ").concat(e," at ").concat(n.join(".")))},exports.expect_type=function(t,e,n){if(typeof t!==e)throw new Error("Expected ".concat(e," not ").concat(typeof t,"(").concat(t,") at ").concat(n.join(".")))},exports.isArrayLike=function(t){return Array.isArray(t)||!!t&&"object"==typeof t&&"length"in t&&"number"==typeof t.length&&(0===t.length||t.length>0&&t.length-1 in t)},exports.validate_schema=i;
//# sourceMappingURL=utils.cjs.map

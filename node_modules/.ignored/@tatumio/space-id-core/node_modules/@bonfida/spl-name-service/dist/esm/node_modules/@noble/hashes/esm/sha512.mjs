import{HashMD as h}from"./_md.mjs";import t from"./_u64.mjs";import{wrapConstructor as c}from"./utils.mjs";const[e,a]=(()=>t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((h=>BigInt(h)))))(),d=new Uint32Array(80),b=new Uint32Array(80);class f extends h{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:h,Al:t,Bh:c,Bl:e,Ch:a,Cl:d,Dh:b,Dl:f,Eh:x,El:s,Fh:r,Fl:i,Gh:l,Gl:o,Hh:H,Hl:n}=this;return[h,t,c,e,a,d,b,f,x,s,r,i,l,o,H,n]}set(h,t,c,e,a,d,b,f,x,s,r,i,l,o,H,n){this.Ah=0|h,this.Al=0|t,this.Bh=0|c,this.Bl=0|e,this.Ch=0|a,this.Cl=0|d,this.Dh=0|b,this.Dl=0|f,this.Eh=0|x,this.El=0|s,this.Fh=0|r,this.Fl=0|i,this.Gh=0|l,this.Gl=0|o,this.Hh=0|H,this.Hl=0|n}process(h,c){for(let t=0;t<16;t++,c+=4)d[t]=h.getUint32(c),b[t]=h.getUint32(c+=4);for(let h=16;h<80;h++){const c=0|d[h-15],e=0|b[h-15],a=t.rotrSH(c,e,1)^t.rotrSH(c,e,8)^t.shrSH(c,e,7),f=t.rotrSL(c,e,1)^t.rotrSL(c,e,8)^t.shrSL(c,e,7),x=0|d[h-2],s=0|b[h-2],r=t.rotrSH(x,s,19)^t.rotrBH(x,s,61)^t.shrSH(x,s,6),i=t.rotrSL(x,s,19)^t.rotrBL(x,s,61)^t.shrSL(x,s,6),l=t.add4L(f,i,b[h-7],b[h-16]),o=t.add4H(l,a,r,d[h-7],d[h-16]);d[h]=0|o,b[h]=0|l}let{Ah:f,Al:x,Bh:s,Bl:r,Ch:i,Cl:l,Dh:o,Dl:H,Eh:n,El:B,Fh:S,Fl:L,Gh:A,Gl:m,Hh:C,Hl:D}=this;for(let h=0;h<80;h++){const c=t.rotrSH(n,B,14)^t.rotrSH(n,B,18)^t.rotrBH(n,B,41),E=t.rotrSL(n,B,14)^t.rotrSL(n,B,18)^t.rotrBL(n,B,41),F=n&S^~n&A,G=B&L^~B&m,p=t.add5L(D,E,G,a[h],b[h]),u=t.add5H(p,C,c,F,e[h],d[h]),g=0|p,U=t.rotrSH(f,x,28)^t.rotrBH(f,x,34)^t.rotrBH(f,x,39),j=t.rotrSL(f,x,28)^t.rotrBL(f,x,34)^t.rotrBL(f,x,39),w=f&s^f&i^s&i,y=x&r^x&l^r&l;C=0|A,D=0|m,A=0|S,m=0|L,S=0|n,L=0|B,({h:n,l:B}=t.add(0|o,0|H,0|u,0|g)),o=0|i,H=0|l,i=0|s,l=0|r,s=0|f,r=0|x;const _=t.add3L(g,j,y);f=t.add3H(_,u,U,w),x=0|_}({h:f,l:x}=t.add(0|this.Ah,0|this.Al,0|f,0|x)),({h:s,l:r}=t.add(0|this.Bh,0|this.Bl,0|s,0|r)),({h:i,l:l}=t.add(0|this.Ch,0|this.Cl,0|i,0|l)),({h:o,l:H}=t.add(0|this.Dh,0|this.Dl,0|o,0|H)),({h:n,l:B}=t.add(0|this.Eh,0|this.El,0|n,0|B)),({h:S,l:L}=t.add(0|this.Fh,0|this.Fl,0|S,0|L)),({h:A,l:m}=t.add(0|this.Gh,0|this.Gl,0|A,0|m)),({h:C,l:D}=t.add(0|this.Hh,0|this.Hl,0|C,0|D)),this.set(f,x,s,r,i,l,o,H,n,B,S,L,A,m,C,D)}roundClean(){d.fill(0),b.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const x=c((()=>new f));export{f as SHA512,x as sha512};
//# sourceMappingURL=sha512.mjs.map

"use strict";var e=require("./modular.cjs"),t=require("./utils.cjs");
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const n=BigInt(0),i=BigInt(1);exports.validateBasic=function(n){return e.validateField(n.Fp),t.validateObject(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...e.nLength(n.n,n.nBitLength),...n,p:n.Fp.ORDER})},exports.wNAF=function(e,t){const r=(e,t)=>{const n=t.negate();return e?n:t},o=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:r,unsafeLadder(t,r){let o=e.ZERO,s=t;for(;r>n;)r&i&&(o=o.add(s)),s=s.double(),r>>=i;return o},precomputeWindow(e,t){const{windows:n,windowSize:i}=o(t),r=[];let s=e,d=s;for(let e=0;e<n;e++){d=s,r.push(d);for(let e=1;e<i;e++)d=d.add(s),r.push(d);s=d.double()}return r},wNAF(t,n,s){const{windows:d,windowSize:a}=o(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),w=2**t,g=BigInt(t);for(let e=0;e<d;e++){const t=e*a;let o=Number(s&l);s>>=g,o>a&&(o-=w,s+=i);const d=t,f=t+Math.abs(o)-1,h=e%2!=0,p=o<0;0===o?u=u.add(r(h,n[d])):c=c.add(r(p,n[f]))}return{p:c,f:u}},wNAFCached(e,t,n,i){const r=e._WINDOW_SIZE||1;let o=t.get(e);return o||(o=this.precomputeWindow(e,r),1!==r&&t.set(e,i(o))),this.wNAF(r,o,n)}}};
//# sourceMappingURL=curve.cjs.map

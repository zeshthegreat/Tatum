"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.namehash = namehash;
var _labelhash = require("./labelhash");
var _ethEnsNamehash = _interopRequireDefault(require("@ensdomains/eth-ens-namehash"));
var _crypto = require("@cosmjs/crypto");
var _encoding = require("@cosmjs/encoding");
function namehash(inputName) {
  var node = '';
  for (var i = 0; i < 32; i++) {
    node += '00';
  }
  var tEncoder = new TextEncoder();
  if (inputName) {
    var labels = inputName.split('.');
    for (var _i = labels.length - 1; _i >= 0; _i--) {
      var labelSha = void 0;
      if ((0, _labelhash.isEncodedLabelhash)(labels[_i])) {
        labelSha = (0, _labelhash.decodeLabelhash)(labels[_i]);
      } else {
        var normalisedLabel = _ethEnsNamehash["default"].normalize(labels[_i]);
        var data = tEncoder.encode(normalisedLabel);
        labelSha = (0, _encoding.toHex)((0, _crypto.keccak256)(data));
      }
      node = (0, _encoding.toHex)((0, _crypto.keccak256)((0, _encoding.fromHex)(node + labelSha)));
    }
  }
  return '0x' + node;
}